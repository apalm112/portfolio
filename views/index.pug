doctype html
html(lang='en')
	head
		meta(charset='UTF-8')
		title Adam Palmer
		meta(name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no')
		//- link( rel='stylesheet' type='text/css' href='https://fonts.googleapis.com/css?family=Droid+Sans')
		link(rel='shortcut icon' href='../favicon.ico' type='image/x-icon')
		link(rel='icon' href='../favicon.ico' type='image/x-icon')
		link(rel='stylesheet' href='./css/bootstrap.min.css')
		link(rel='stylesheet' href='./libs/font-awesome/css/font-awesome.css')
		link(rel='stylesheet' href='./css/app.css')
		script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js')
		script(type='text/javascript' href='./js/bootstrap.min.js')
	body(data-spy='scroll' data-target='.navbar' data-offset='10')
		include partials/nav.pug
		include includes/header.pug
		main.container-main
			include partials/about.pug
			include partials/education.pug
			include partials/projects.pug
			include partials/skills.pug
			include partials/experience.pug
			include partials/contact.pug
		include includes/footer.pug
		script(type='text/javascript').
			(function($) {
				// Sticky NavBar feature
				window.onscroll = function() {stickyNav()};
				
				const navbar = document.getElementById('navbar');
				const sticky = navbar.offsetTop-110;
				
				function stickyNav() {
					if (window.pageYOffset > sticky) {
						navbar.classList.add('sticky');
						} else {
							navbar.classList.remove('sticky');
						}
				}
				
				// Scroll to top
				$('#to-top').click(function() {
						$('html, body').animate({
								scrollTop: 0
						}, 500);
				});

				// Create timeline
				$('#experience-timeline').each(function() {

						$this = $(this); // Store reference to this
						$userContent = $this.children('div'); // user content

						// Create each timeline block
						$userContent.each(function() {
								$(this).addClass('vtimeline-content').wrap('<div class="vtimeline-point"><div class="vtimeline-block"></div></div>');
						});

						// Add icons to each block
						$this.find('.vtimeline-point').each(function() {
								$(this).prepend('<div class="vtimeline-icon"><i class="fa fa-map-marker"></i></div>');
						});

						// Add dates to the timeline if exists
						$this.find('.vtimeline-content').each(function() {
								var date = $(this).data('date');
								if (date) { // Prepend if exists
										$(this).parent().prepend('<span class="vtimeline-date">'+date+'</span>');
								}
						});

				});

				let mainNavLinks = document.querySelectorAll("nav ul li a");
				let mainSections = document.querySelectorAll("main div");

				let lastId;
				let cur = [];

				window.addEventListener("scroll", event => {
				  let fromTop = window.scrollY;

				  mainNavLinks.forEach(link => {
				    let section = document.querySelector(link.hash);

				    if (
				      section.offsetTop <= fromTop &&
				      section.offsetTop + section.offsetHeight > fromTop
				    ) {
				      link.classList.add("current");
				    } else {
				      link.classList.remove("current");
				    }
				  });
				});

			})(jQuery);
